{"version":3,"names":["React","useState","useEffect","useCallback","View","FlatList","SafeAreaView","mainContainerStyle","SeatContainer","SeatsLayout","row","layout","columnOne","columnTwo","isSleeperLayout","driverPosition","maxSeatToSelect","selectedSeats","seatImage","undefined","blockedSeatImage","driverImage","numberTextStyle","getBookedSeats","bookingSeat","setBookingSeat","userSelectedSeats","setUserSelectedSeat","isEntryDoorAtFront","allArray","i","seatNumber","j","seatArray","seatLayout","id","type","push","iTotalColumn","bSpaceAdded","revCounter","preSelectedSeatItem","filter","item","length","seatType","seatNo","isSeatSeleced","onSeatSelected","seat","allChangedItem","arrindexs","split","map","Number","changeItem","isStatusChange","getSelectedSeats","bookingSeatArg","filterSelectedSeats","flatMap","rowSeatArr","rowSeat","renderSeatlayout","index","Math","random","toString","memo"],"sources":["index.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  FlatList,\n  SafeAreaView,\n  // Image,\n  // Text,\n  TextStyle,\n} from 'react-native';\nimport type {\n  AvaiableSeat,\n  BlockedSeat,\n  DriverPosition,\n  DriverSeat,\n  Layout,\n  SeatLayout,\n  SelectedSeats,\n} from './types';\nimport {\n  // instructionSeatLayout,\n  // layoutImage,\n  mainContainerStyle,\n  // seatImageStyle,\n  // seatNumberStyle,\n  // selectedSeatColor,\n} from './styles';\nimport SeatContainer from './component/SeatContainer';\n\n/*\nThis are props that require to pass in order to get seat layout\n*/\nexport interface SeatsLayoutProps {\n  row: number;\n  layout: Layout;\n  driverPosition?: DriverPosition;\n  isSleeperLayout?: boolean;\n  maxSeatToSelect?: number;\n  selectedSeats?: Array<SelectedSeats>;\n  seatImage?: AvaiableSeat;\n  blockedSeatImage?: BlockedSeat;\n  driverImage?: DriverSeat;\n  numberTextStyle?: TextStyle;\n  getBookedSeats?: (seats: Array<SeatLayout>) => void;\n}\nconst SeatsLayout: React.FC<SeatsLayoutProps> = ({\n  row = 10,\n  layout = { columnOne: 2, columnTwo: 2 },\n  isSleeperLayout = false,\n  driverPosition = 'right',\n  maxSeatToSelect = 7,\n  selectedSeats = [],\n  seatImage = undefined,\n  blockedSeatImage = undefined,\n  driverImage = undefined,\n  numberTextStyle,\n  getBookedSeats,\n}) => {\n  const [bookingSeat, setBookingSeat] = useState<Array<Array<SeatLayout>>>([]);\n  const [userSelectedSeats, setUserSelectedSeat] = useState<Array<SeatLayout>>(\n    []\n  );\n  const isEntryDoorAtFront = true;\n\n  useEffect(() => {\n    let allArray: Array<Array<SeatLayout>> = [];\n    let i = 0;\n    let seatNumber = 1;\n\n    while (i < row) {\n      let j = 0;\n      let seatArray: Array<SeatLayout> = [];\n      let seatLayout: SeatLayout = {\n        id: '-1',\n        type: 'blocked',\n      };\n      if (i === 0 && j === 0) {\n        // Add Bus layout has at front door\n        // if (isEntryDoorAtFront) {\n        seatLayout = {\n          id: `${i},${j}`,\n          type: driverPosition === 'left' ? 'driver' : 'emptySpace',\n          // type: driverPosition == 'left' ? 'driver' : 'emptySpace',\n        };\n        seatArray.push(seatLayout);\n        // }\n\n        //Render empty space to show driver seat at last row and\n        while (j < layout.columnOne + layout.columnTwo) {\n          let iTotalColumn = layout.columnOne + layout.columnTwo;\n          seatLayout = {\n            id: '-1',\n            type: 'blocked',\n          };\n          if (j === iTotalColumn - 1) {\n            seatLayout = {\n              id: `${i},${j}`,\n              type: driverPosition === 'left' ? 'emptySpace' : 'driver',\n              // type: driverPosition == 'left' ? 'emptySpace' : 'driver',\n            };\n            seatArray.push(seatLayout);\n          } else {\n            seatLayout = {\n              id: `${i},${j}`,\n              type: 'emptySpace',\n            };\n            seatArray.push(seatLayout);\n          }\n          if (!isEntryDoorAtFront && j === layout.columnOne - 1) {\n            seatLayout = {\n              id: `${i},${j}`,\n              type: 'emptySpace',\n            };\n            seatArray.push(seatLayout);\n          }\n          j += 1;\n        }\n      } else {\n        //Set Index value in id to all seat type for to make them selectable.\n        let bSpaceAdded = false;\n        let revCounter = i * (layout.columnOne + layout.columnTwo);\n\n        while (j < layout.columnOne + layout.columnTwo) {\n          let preSelectedSeatItem = selectedSeats.filter((item) => {\n            return item.seatNumber === (i % 2 === 0 ? revCounter : seatNumber);\n          });\n\n          seatLayout = {\n            id: `${i},${bSpaceAdded ? j + 1 : j}`,\n            type:\n              preSelectedSeatItem.length > 0\n                ? preSelectedSeatItem[0].seatType\n                : 'available',\n            seatNo: i % 2 === 0 ? revCounter : seatNumber,\n            isSeatSeleced: preSelectedSeatItem.length > 0,\n          };\n\n          seatArray.push(seatLayout);\n          if (j === layout.columnOne - 1) {\n            seatLayout = {\n              id: `${i},${j + 1}`,\n              type:\n                i === row - 1\n                  ? preSelectedSeatItem.length > 0\n                    ? preSelectedSeatItem[0].seatType\n                    : 'available'\n                  : 'emptySpace',\n              seatNo: i % 2 === 0 || i !== row - 1 ? revCounter : seatNumber,\n              isSeatSeleced:\n                i === row - 1 ? preSelectedSeatItem.length > 0 : false,\n            };\n            seatArray.push(seatLayout);\n            bSpaceAdded = true;\n          }\n          j += 1;\n          revCounter -= 1;\n          seatNumber += 1;\n        }\n      }\n      allArray.push(seatArray);\n      i += 1;\n    }\n    setBookingSeat(allArray);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    getBookedSeats && getBookedSeats(userSelectedSeats);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userSelectedSeats]);\n\n  const onSeatSelected = useCallback(\n    (seat: SeatLayout) => {\n      let allChangedItem: Array<Array<SeatLayout>> = bookingSeat;\n      const { id } = seat;\n      const arrindexs: Array<number> = id\n        .split(',')\n        .map((item) => Number(item));\n      let changeItem = seat;\n      changeItem.type = changeItem.type == 'available' ? 'booked' : 'available';\n      changeItem.isStatusChange = true;\n      allChangedItem[arrindexs[0]][arrindexs[1]] = changeItem;\n\n      setBookingSeat([...allChangedItem]);\n      getSelectedSeats([...allChangedItem]);\n    },\n    [bookingSeat]\n  );\n\n  const getSelectedSeats = (bookingSeatArg: Array<Array<SeatLayout>>) => {\n    let filterSelectedSeats = bookingSeatArg.flatMap((rowSeatArr) => {\n      return rowSeatArr.filter((rowSeat) => {\n        return rowSeat.type === 'booked' && rowSeat.isStatusChange;\n      });\n    });\n    setUserSelectedSeat(filterSelectedSeats);\n  };\n\n  const renderSeatlayout = (item: Array<SeatLayout>, index: number) => {\n    return (\n      <SeatContainer\n        item={item}\n        index={index}\n        isSleeperLayout={isSleeperLayout}\n        seatImage={seatImage}\n        driverImage={driverImage}\n        blockedSeatImage={blockedSeatImage}\n        numberTextStyle={numberTextStyle}\n        disableSeat={userSelectedSeats.length === maxSeatToSelect}\n        onSeatSelected={(seat) => {\n          onSeatSelected(seat);\n        }}\n      />\n    );\n  };\n\n  // let arrPreviewSeats: Array<SeatLayout> = [\n  //   {\n  //     id: '1',\n  //     type: 'available',\n  //     isStatusChange: false,\n  //   },\n  //   {\n  //     id: '2',\n  //     type: 'booked',\n  //     isStatusChange: false,\n  //   },\n  //   {\n  //     id: '3',\n  //     type: 'women',\n  //     isStatusChange: false,\n  //   },\n  //   {\n  //     id: '4',\n  //     type: 'blocked',\n  //     isStatusChange: false,\n  //   },\n  // ];\n\n  /* \n  Render All seat for header to identify to user\n  */\n  // const renderSeatConfig = (seatData: SeatLayout) => {\n  //   return (\n  //     <>\n  //       {seatData.type == 'available' && (\n  //         <Image\n  //           source={\n  //             seatImage != undefined\n  //               ? seatImage.image\n  //               : layoutImage[seatData.type]\n  //           }\n  //           style={[\n  //             seatImageStyle,\n  //             {\n  //               tintColor:\n  //                 seatImage != undefined\n  //                   ? seatImage.tintColor\n  //                   : selectedSeatColor[seatData.type],\n  //             },\n  //           ]}\n  //           resizeMode=\"contain\"\n  //         />\n  //       )}\n  //       {seatData.type == 'booked' && (\n  //         <Image\n  //           source={\n  //             seatImage != undefined\n  //               ? seatImage.image\n  //               : layoutImage[seatData.type]\n  //           }\n  //           style={[\n  //             seatImageStyle,\n  //             {\n  //               tintColor: selectedSeatColor[seatData.type],\n  //             },\n  //           ]}\n  //           resizeMode=\"contain\"\n  //         />\n  //       )}\n  //       {seatData.type == 'women' && (\n  //         <Image\n  //           source={\n  //             seatImage != undefined\n  //               ? seatImage.image\n  //               : layoutImage[seatData.type]\n  //           }\n  //           style={[\n  //             seatImageStyle,\n  //             {\n  //               tintColor: selectedSeatColor[seatData.type],\n  //             },\n  //           ]}\n  //           resizeMode=\"contain\"\n  //         />\n  //       )}\n  //       {seatData.type == 'blocked' && (\n  //         <Image\n  //           source={\n  //             blockedSeatImage != undefined\n  //               ? blockedSeatImage\n  //               : layoutImage[seatData.type]\n  //           }\n  //           style={[\n  //             seatImageStyle,\n  //             { tintColor: selectedSeatColor[seatData.type] },\n  //           ]}\n  //           resizeMode=\"contain\"\n  //         />\n  //       )}\n\n  //       <Text style={seatNumberStyle}>{seatData.type}</Text>\n  //     </>\n  //   );\n  // };\n\n  return (\n    <SafeAreaView>\n      <View style={mainContainerStyle}>\n        {/* <View style={instructionSeatLayout}>\n          {arrPreviewSeats.map((item: SeatLayout) => renderSeatConfig(item))}\n        </View> */}\n        <FlatList\n          showsVerticalScrollIndicator={false}\n          bounces={false}\n          data={[...bookingSeat]}\n          renderItem={({ item, index }) => {\n            return renderSeatlayout(item, index);\n          }}\n          keyExtractor={() => Math.random().toString()}\n        />\n      </View>\n    </SafeAreaView>\n  );\n};\n\nexport default React.memo(SeatsLayout);\n"],"mappings":"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CA;EACA;EACA;EACA;EACA;EACA;;EAEA;AACF;AACA;EACE;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA,oBACE,oBAAC,YAAY,qBACX,oBAAC,IAAI;IAAC,KAAK,EAAE1C;EAAmB,gBAI9B,oBAAC,QAAQ;IACP,4BAA4B,EAAE,KAAM;IACpC,OAAO,EAAE,KAAM;IACf,IAAI,EAAE,CAAC,GAAGiB,WAAW,CAAE;IACvB,UAAU,EAAE,SAAqB;MAAA,IAApB;QAAEmB,IAAI;QAAEqB;MAAM,CAAC;MAC1B,OAAOD,gBAAgB,CAACpB,IAAI,EAAEqB,KAAK,CAAC;IACtC,CAAE;IACF,YAAY,EAAE,MAAMC,IAAI,CAACC,MAAM,EAAE,CAACC,QAAQ;EAAG,EAC7C,CACG,CACM;AAEnB,CAAC;AAED,4BAAenE,KAAK,CAACoE,IAAI,CAAC3D,WAAW,CAAC"}